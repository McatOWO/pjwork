<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AI清掃ナビゲーター</title>
  <link rel="stylesheet" href="/static/styles.css" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
  <header class="hud-header">
    <div class="hud-item">
      <div class="label">ROOM</div>
      <div class="value">101</div>
    </div>
    <div class="hud-item">
      <div class="label">TIME</div>
      <div class="value" id="timerDisplay">00:00</div>
    </div>
    <div class="hud-item">
      <div class="label">TARGET</div>
      <div class="value">20:00</div>
    </div>
    <div class="hud-item">
      <div class="label">SCORE</div>
      <div class="value" id="totalScore">--</div>
    </div>
  </header>

  <main class="container">
    <section class="panel map-panel">
      <div class="mapWrap" id="mapWrap">
        <img class="mapImage" src="/static/room_map.png" alt="Room Map" />
        <svg id="routeLines" class="route-overlay"></svg>
        <div class="mapPins" id="mapPins"></div>
      </div>
      
      <div class="nav-instruction" id="navInstruction">
        <span class="nav-icon">➤</span>
        <span id="navText">清掃を開始してください</span>
      </div>
    </section>

    <section class="panel task-panel" id="currentTaskPanel" style="display:none;">
      <h2 class="panel__title">現在のタスク</h2>
      <div id="activeTaskCard"></div>
    </section>

    <details class="panel">
      <summary class="panel__title">タスク一覧・進捗詳細</summary>
      <div id="taskList" class="taskList"></div>
    </details>

    <div class="actions">
      <button id="resetBtn" class="btn btn--danger">業務リセット</button>
      <button id="finishBtn" class="btn btn--primary" disabled>業務完了・レポート送信</button>
    </div>
  </main>

  <div class="modal" id="modal" aria-hidden="true">
    <div class="modal__backdrop" id="modalBackdrop"></div>
    <div class="modal__panel">
      <div class="modal__head">
        <h3 class="modal__title" id="modalTitle">チェック</h3>
        <button class="btn btn--ghost" id="modalClose">閉じる</button>
      </div>
      <div id="modalBody"></div>
    </div>
  </div>

  <div class="modal" id="reportModal" aria-hidden="true">
    <div class="modal__backdrop"></div>
    <div class="modal__panel">
      <div class="modal__head">
        <h3 class="modal__title">業務完了レポート</h3>
        <button class="btn btn--ghost" onclick="location.reload()">閉じる</button>
      </div>
      <div class="modal__body">
        <p>以下のデータが管理サーバーへ送信されました。</p>
        <pre id="reportData" class="code-block"></pre>
        <button class="btn btn--primary" onclick="location.reload()">次の部屋へ</button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.20.0/dist/tf.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script>
  <script src="/static/app.js"></script>
</body>
</html>